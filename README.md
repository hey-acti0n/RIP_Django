# Django Асинхронный Сервис для расчета стоимости

Этот сервис выполняет асинхронный расчет `total_cost` для заявок из основного Go сервиса.

## Установка и запуск

1. Активируйте виртуальное окружение:
```bash
source venv/bin/activate
```

2. Установите зависимости (если еще не установлены):
```bash
pip install -r requirements.txt
```

3. Запустите сервер:
```bash
python manage.py runserver
```

Сервер будет доступен по адресу: `http://localhost:8000`

## API

### POST /calculate-cost

Запускает асинхронный расчет стоимости для заявки.

**Запрос:**
```json
{
  "calculation_id": 1
}
```

или

```json
{
  "pk": 1
}
```

**Ответ:**
```json
{
  "message": "Calculation initiated",
  "calculation_id": 1,
  "status": "processing"
}
```

## Как это работает

1. Сервис получает `calculation_id` в POST запросе
2. Запускает расчет в отдельном потоке (threading)
3. Выполняет задержку 5-10 секунд
4. Генерирует случайный результат (успех/неуспех):
   - При успехе: случайная стоимость от 1000 до 10000
   - При неуспехе: 0
5. Отправляет PUT запрос к основному Go сервису (`http://localhost:8080/api/v1/calculations/{id}/update-result`) с токеном авторизации

## Конфигурация

- Токен авторизации: `secret123` (8 байт)
- URL основного сервиса: `http://localhost:8080/api/v1`
- Задержка расчета: 5-10 секунд (случайная)
